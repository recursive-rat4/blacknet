// Auto-generated with rings.sage

#ifndef BLACKNET_CRYPTO_FERMAT_H
#define BLACKNET_CRYPTO_FERMAT_H

#include <array>

#include "integerring.h"

struct FermatRingParams {
    using I = int32_t;
    using L = int64_t;
    using UI = uint32_t;
    using UL = uint64_t;

    constexpr static const I M = 65537;
    constexpr static const I R2 = 1;
    constexpr static const I RN = -65535;
    constexpr static const std::array<I, 512> ZETAS = {1, -256, 4096, 16, 64, -16384, -4, 1024, 8, -2048, 32768, 128, 512, 2, -32, 8192, -8160, -8224, 510, 514, 2056, -2040, 32640, -32641, 257, -255, 4080, 4112, 16448, -16320, -1028, 1020, 11414, 27181, 23863, -13987, 9589, -29915, 19881, 22350, 25775, 20837, -5707, 19178, 11175, 22828, 27974, -17811, -10163, -19752, -11653, -31534, 4938, -18925, -24885, 13471, -15767, -26942, -27687, 9876, -26033, -20326, -2469, -23306, 18048, -32698, -1128, 26620, -24594, 4512, -6655, -282, 13310, 564, -9024, 16349, -141, -29441, 12297, -2256, -10041, 14553, 29300, -29582, 12746, 13874, -25373, 7325, -14791, -14650, -27748, 25492, -29106, -20082, -6373, -6937, 17081, 18243, -29740, 11148, -20945, -12114, -2787, -7435, 5574, 14870, 24228, 23647, 29051, -31375, -22296, 6057, 16239, -28353, -5111, -2324, -9296, 20444, 581, -17662, -1162, -30213, 24649, -18592, -8831, 32478, 4648, -10222, -10850, 25046, -7514, 23011, 26507, 30056, -22137, 30890, -21263, 3757, 5425, -12523, 15445, -21700, 19515, -15028, -4487, -30994, -28392, -6255, -25020, -17506, 17948, -7098, 29641, 14196, -30525, 15497, -3549, -8974, 12510, 8753, 23030, 2650, 23137, -24742, 32106, -27011, -26583, -10600, -12371, 21200, -11515, -1325, -5300, -19477, -16053, -19263, -30221, 3210, 14177, -24777, 31966, 8829, -10190, -12840, 20380, 25680, -17658, -1605, -6420, 5095, -15983, 28354, 3756, 21519, -16619, -5441, -21764, 939, -15024, -20539, 30048, -24459, -1878, 22009, 22499, 7512, 10882, 32299, 22356, -21417, 14987, 30011, -11030, 5589, -23887, 20131, -17763, 25275, -11178, -22060, -22703, -20825, 5515, 29974, 9786, -14810, -25188, 25502, -29066, -30322, 26393, -6297, 12751, 12594, -4893, 7405, 29620, 19572, 14533, 15161, -29694, -628, 10048, -16345, 157, 25345, -12298, 2512, 24596, -5024, 14847, 314, 1256, 6149, 32690, 20096, 431, 20738, -4123, 6896, 27584, 16492, -1724, -17415, 3448, -30707, 32553, -10369, 24061, 862, -13792, -8246, 22038, -5546, 23199, 24923, -31382, -27259, -22615, 22184, -20307, 21169, -11019, 2773, 11092, -21461, 15691, -19139, 4159, -16112, -4356, 1007, 4028, 17424, -16636, -1089, -32265, 2178, 30689, 8056, 32224, 8318, -2014, -8712, 10726, 6698, 23906, -24995, 31094, -30087, 22633, -26792, 20271, -11953, -5363, -3349, -13396, 21452, -15547, -17725, -20215, -2383, -27409, 4245, 16980, -21438, 15323, 9532, -30646, -19064, -22661, -31577, 4766, 25107, -8490, 10719, -2229, -19209, -20341, 29873, -11582, 15827, 8916, 11299, -17832, -22598, -31654, -23164, -27119, -4458, 5791, 24855, 21767, -1707, 27312, 20587, 16811, 21826, -21531, 6828, -22475, -13656, 21885, -31915, 3414, -22003, 24363, -10913, -13450, -30261, 25417, -18589, -8819, 29406, -11737, -10030, 23474, 20060, 6725, -17638, -5015, -26900, -28359, -14703, -23223, -18779, -27221, 21654, 21079, -22190, 27355, 9579, 10827, -19158, -21157, -23379, -27979, 19091, 22229, 11095, 32213, 11134, 18467, -8888, 29985, -8331, 2222, 21001, -4444, 23535, 16662, -5567, -22268, -1111, 17776, -28603, 29843, 28021, 10423, 18729, 9379, 23845, 11702, 18990, -23404, 27557, 17847, 18758, 9495, -5851, 28079, 20846, 16612, 7233, 15346, 3644, 14576, 4153, -911, -28932, 1822, -7673, -8306, 29152, -14466, -32313, -7288, 30692, -19589, -31565, -19256, 14261, -8493, 11487, 12819, -4814, -25638, 9628, -22974, -16986, -2407, 26359, -28522, 27025, 1497, 9990, -28766, 23952, 30271, -16010, -5988, 25577, 11976, 14383, 32020, -4995, -19980, 2994, 17633, 8005, 23398, -26021, 23114, -18854, -9879, -26919, -28055, -26990, -9427, -11557, -11699, -19758, -13495, -18741, -27829, -19309, -18399, -8520, 5246, -32236, 2130, -20984, 8059, -31457, -16118, -2623, -23569, 4260, 17040, 28739, -1065, 10492};

    constexpr static I reduce(I x) {
        return (x & 0xFFFF) - (x >> 16);
    }
    constexpr static I freeze(I x) {
        return x + ((x >> 31) & 65537);
    }
};

// 2ยนโถ + 1
typedef IntegerRing<FermatRingParams> FermatRing;

#endif
